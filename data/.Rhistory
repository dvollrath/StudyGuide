p <- p %>% group_by(isocode) %>% mutate(lead.ln_rgdpo_pop = dplyr::lead(ln_rgdpo_pop, n = 30, default = NA))
p$gy <- (p$lead.ln_rgdpo_pop - p$ln_rgdpo_pop)/30 # population growth rate
p$kystar <- p$mean_csh_i/(.018 + .05 + p$gpop)
p$ratio <- p$ky/p$kystar
p <- p[p$year==1989,]
p <- pwt10.0 # save into dataframe
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p$ln_rgdpo_pop <- log(p$rgdpo_pop)
p$ky <- round(p$rnna/p$rgdpna,digits=2)
p <- p[p$year>1988,] # limit to 1989 and after
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.4,]
p <- p %>% group_by(isocode) %>% mutate(lag30.pop = dplyr::lag(pop, n = 30, default = NA))
p$gpop <- (log(p$pop) - log(p$lag30.pop))/30 # population growth rate
p <- p[p$gpop<.04,]
View(p)
p <- pwt10.0 # save into dataframe
## Create cross-sectional plots
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p[p$year>1988,] # limit to 1989 and after
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.4,] # eliminate outliers on cap formation share
# get lagged population
p <- p %>% group_by(isocode) %>% mutate(lag30.pop = dplyr::lag(pop, n = 30, default = NA))
p$gpop <- (log(p$pop) - log(p$lag30.pop))/30 # population growth rate
p <- p[p$gpop<.04,] # eliminate outliers
p <- p[p$year==2019,] # narrow to only 2019
p <- p[p$rgdpo_pop<100000 & p$rgdpo_pop>500,] # eliminate outliers
## Plot GDP per capita against capital formation share
f <- ggplot(p, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0.05,0.1,0.15,0.2,0.25,0.3),limits=c(0.05,0.3)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
p <- pwt10.0 # save into dataframe
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p$ln_rgdpo_pop <- log(p$rgdpo_pop)
p$ky <- round(p$rnna/p$rgdpna,digits=2)
p <- p[p$year>1988,] # limit to 1989 and after
View(p)
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.4,] # eliminate outliers on cap formation share
p <- p %>% group_by(isocode) %>% mutate(lag30.pop = dplyr::lag(pop, n = 30, default = NA))
p$gpop <- (log(p$pop) - log(p$lag30.pop))/30 # population growth rate
View(p)
p <- p[p$gpop<.04,] # eliminate outliers
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.4,] # eliminate outliers on cap formation share
p <- p %>% group_by(isocode) %>% mutate(lead30.pop = dplyr::lead(pop, n = 30, default = NA))
p$gpop <- (log(p$lead30.pop) - log(p$pop))/30 # population growth rate
p <- p[p$gpop<.04,] # eliminate outliers
p <- p %>% group_by(isocode) %>% mutate(lead.ln_rgdpo_pop = dplyr::lead(ln_rgdpo_pop, n = 30, default = NA))
p$gy <- (p$lead.ln_rgdpo_pop - p$ln_rgdpo_pop)/30 # population growth rate
View(p)
p <- pwt10.0 # save into dataframe
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p$ln_rgdpo_pop <- log(p$rgdpo_pop)
p$ky <- round(p$rnna/p$rgdpna,digits=2)
p <- p[p$year>1988,] # limit to 1989 and after
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.4,] # eliminate outliers on cap formation share
p <- p %>% group_by(isocode) %>% mutate(lead30.pop = dplyr::lead(pop, n = 30, default = NA))
p$gpop <- (log(p$lead30.pop) - log(p$pop))/30 # population growth rate
View(p)
p <- p %>% group_by(isocode) %>% mutate(lead.ln_rgdpo_pop = dplyr::lead(ln_rgdpo_pop, n = 30, default = NA))
View(p)
p$gy <- (p$lead.ln_rgdpo_pop - p$ln_rgdpo_pop)/30 # population growth rate
View(p)
p$kystar <- p$mean_csh_i/(.018 + .05 + p$gpop)
p$ratio <- p$ky/p$kystar
View(p)
f <- ggplot(p, aes(x = ratio, y = gy, label = isocode)) +
geom_text(size=3) +
labs(x = "Ratio of KY to KYstar, 1989", y = "Growth rate of GDP per capita") +
theme_bw()
f
p <- p[p$ratio<4,]
f <- ggplot(p, aes(x = ratio, y = gy, label = isocode)) +
geom_text(size=3) +
labs(x = "Ratio of KY to KYstar, 1989", y = "Growth rate of GDP per capita") +
theme_bw()
f
f <- ggplot(p, aes(x = ratio, y = gy, label = isocode)) +
geom_text(size=3) +
labs(x = "Ratio of KY to KYstar, 1989", y = "Growth rate of GDP per capita") +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
summarise(p$ky)
summarize(p$ky)
summary(p$ky)
summary(p$kystar)
p <- pwt10.0 # save into dataframe
## Create cross-sectional plots
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p[p$year>1988,] # limit to 1989 and after
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.4,] # eliminate outliers on cap formation share
# get lagged population
p <- p %>% group_by(isocode) %>% mutate(gpop = (log(pop) - log(lag(pop, n = 30, default = NA)))/30)
View(p)
p <- p %>% group_by(isocode) %>% mutate(lag30.pop = dplyr::lag(pop, n = 30, default = NA))
p$gpop2 <- (log(p$pop) - log(p$lag30.pop))/30 # population growth rate
View(p)
#############################################################################
# Chapter 3 cross-sectional figures
#############################################################################
data("pwt10.0") # extract PWT data
p <- pwt10.0 # save into dataframe
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.4,] # eliminate outliers
p <- p %>% group_by(isocode) # 30-year avg population growth rate
%>% mutate(gpop = (log(pop) - log(lag(pop, n = 30)))/30)
p <- p[p$gpop<.04,] # eliminate outliers
p <- p[p$year==2019,] # narrow to only 2019
p <- p[p$rgdpo_pop<100000 & p$rgdpo_pop>500,] # eliminate outliers
## Plot GDP per capita against capital formation share
f <- ggplot(p, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0.05,0.1,0.15,0.2,0.25,0.3),limits=c(0.05,0.3)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
#############################################################################
# Chapter 3 cross-sectional figures
#############################################################################
data("pwt10.0") # extract PWT data
p <- pwt10.0 # save into dataframe
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.4,] # eliminate outliers
p <- p[p$year==2019,] # narrow to only 2019
p <- p[p$rgdpo_pop<100000 & p$rgdpo_pop>500,] # eliminate outliers
## Plot GDP per capita against capital formation share
f <- ggplot(p, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0.05,0.1,0.15,0.2,0.25,0.3),limits=c(0.05,0.3)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
#############################################################################
# Chapter 3 cross-sectional figures
#############################################################################
data("pwt10.0") # extract PWT data
p <- pwt10.0 # save into dataframe
p <- p[p$year>1988,] # use only 1989 and forward
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.4,] # eliminate outliers
p <- p[p$year==2019,] # narrow to only 2019
p <- p[p$rgdpo_pop<100000 & p$rgdpo_pop>500,] # eliminate outliers
## Plot GDP per capita against capital formation share
f <- ggplot(p, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0.05,0.1,0.15,0.2,0.25,0.3),limits=c(0.05,0.3)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
#############################################################################
# Chapter 3 cross-sectional figures
#############################################################################
data("pwt10.0") # extract PWT data
p <- pwt10.0 # save into dataframe
#p <- p[p$year>1988,] # use only 1989 and forward
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i,na.rm = TRUE)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.4,] # eliminate outliers
p <- p[p$year==2019,] # narrow to only 2019
p <- p[p$rgdpo_pop<100000 & p$rgdpo_pop>500,] # eliminate outliers
## Plot GDP per capita against capital formation share
f <- ggplot(p, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0.05,0.1,0.15,0.2,0.25,0.3),limits=c(0.05,0.3)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
#############################################################################
# Chapter 3 cross-sectional figures
#############################################################################
data("pwt10.0") # extract PWT data
p <- pwt10.0 # save into dataframe
#p <- p[p$year>1988,] # use only 1989 and forward
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i,na.rm = TRUE)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.5,] # eliminate outliers
p <- p[p$year==2019,] # narrow to only 2019
p <- p[p$rgdpo_pop<100000 & p$rgdpo_pop>500,] # eliminate outliers
## Plot GDP per capita against capital formation share
f <- ggplot(p, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45),limits=c(0.05,0.5)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
#############################################################################
# Chapter 3 cross-sectional figures
#############################################################################
data("pwt10.0") # extract PWT data
p <- pwt10.0 # save into dataframe
#p <- p[p$year>1988,] # use only 1989 and forward
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i,na.rm = TRUE)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.5,] # eliminate outliers
p <- p[p$year==2019,] # narrow to only 2019
p <- p[p$rgdpo_pop<100000 & p$rgdpo_pop>500,] # eliminate outliers
## Plot GDP per capita against capital formation share
f <- ggplot(p, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0.05,0.5)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
f <- ggplot(p, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0,0.5)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
#############################################################################
# Chapter 3 cross-sectional figures
#############################################################################
data("pwt10.0") # extract PWT data
p <- pwt10.0 # save into dataframe
#p <- p[p$year>1988,] # use only 1989 and forward
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i,na.rm = TRUE)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.5,] # eliminate outliers
p <- p %>% group_by(isocode) # 30-year avg population growth rate
%>% mutate(gpop = (log(pop) - log(lag(pop, n = 30)))/30)
p <- p[p$gpop<.04,] # eliminate outliers
p <- p[p$year==2019,] # narrow to only 2019
p <- p[p$rgdpo_pop<100000 & p$rgdpo_pop>500,] # eliminate outliers
## Plot GDP per capita against capital formation share
f <- ggplot(p, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0,0.5)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
f <- ggplot(p, aes(x = gpop, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. growth rate of population, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(-0.01,0,0.01,0.02,0.03,0.04),limits=c(-0.01,0.04)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
p <- p %>% group_by(isocode) # 30-year avg population growth rate
%>% mutate(gpop = (log(pop) - log(lag(pop, n = 30)))/30)
p <- p[p$gpop<.04,] # eliminate outliers
p <- p %>% group_by(isocode) %>% # 30-year population growth rate
mutate(gpop = (log(pop) - log(lag(pop, n = 30)))/30)
p <- p[p$gpop<.04,] # eliminate outliers
f <- ggplot(p, aes(x = gpop, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. growth rate of population, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(-0.01,0,0.01,0.02,0.03,0.04),limits=c(-0.01,0.04)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
#############################################################################
# Chapter 3 cross-sectional figures
#############################################################################
data("pwt10.0") # extract PWT data
p <- pwt10.0 # save into dataframe
#p <- p[p$year>1988,] # use only 1989 and forward
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i,na.rm = TRUE)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.5,] # eliminate outliers
p <- p %>% group_by(isocode) %>% # 30-year population growth rate
mutate(gpop = (log(pop) - log(lag(pop, n = 30)))/30)
p <- p[p$gpop<.04,] # eliminate outliers
p <- p[p$year==2019,] # narrow to only 2019
p <- p[p$rgdpo_pop<100000 & p$rgdpo_pop>500,] # eliminate outliers
View(p)
f <- ggplot(p, aes(x = gpop, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. growth rate of population, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(-0.01,0,0.01,0.02,0.03,0.04),limits=c(-0.01,0.04)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
f
p <- p[p$year==2019,] # narrow to only 2019
View(p)
drafts = "~/Dropbox/project/Growth4ed/Figures"
f <- ggplot(p, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0,0.5)) +
geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
ggsave("Ch3_xsection_csh_i.eps",path=drafts)
api_create(fig, filename = "Ch3-xsection-csh_i")
library(plotly)
source("~/Dropbox/Tools/.Rprofile")
api_create(fig, filename = "Ch3-xsection-csh_i")
api_create(f, filename = "Ch3-xsection-csh_i")
f <- ggplot(p, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0,0.5)) +
#    geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
ggsave("Ch3_xsection_csh_i.eps",path=drafts)
api_create(f, filename = "Ch3-xsection-csh_i")
d <- p[p$year==2019,] # narrow to only 2019 for graphing and uploading
## Plot GDP per capita against capital formation share
f <- ggplot(d, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0,0.5)) +
#    geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
p <- p %>% drop_na(year)
#############################################################################
# Chapter 3 cross-sectional figures
#############################################################################
data("pwt10.0") # extract PWT data
p <- pwt10.0 # save into dataframe
#p <- p[p$year>1988,] # use only 1989 and forward
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i,na.rm = TRUE)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.5,] # eliminate outliers
p <- p %>% group_by(isocode) %>% # 30-year population growth rate
mutate(gpop = (log(pop) - log(lag(pop, n = 30)))/30)
p <- p[p$gpop<.04,] # eliminate outliers
p <- p[p$rgdpo_pop<100000 & p$rgdpo_pop>500,] # eliminate outliers
p <- p[p$year==2019,] # narrow to only 2019 for graphing and uploading
p <- p %>% drop_na(year)
## Plot GDP per capita against capital formation share
f <- ggplot(d, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0,0.5)) +
#    geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
ggsave("Ch3_xsection_csh_i.eps",path=drafts)
api_create(f, filename = "Ch3-xsection-csh_i")
up <- ggplotly(f) # convert to plotly
api_create(up, filename = "Ch3-xsection-csh_i") # upload to plotly
# Uses PWT to create a large number of figures used in Study Guide
##################################################################################
# Pull PWT into dataframe
data("pwt9.1")
##################################################################################
# Create variables for figures
##################################################################################
p <- pwt9.1 # copy dataframe for manipulation
p$lngdppc <- round(log(p$rgdpna) - log(p$pop),digits=2) # create log GDP per capita
p$lnpop <- round(log(p$pop),digits=2) # create log population
p$ky <- round(p$rnna/p$rgdpna,digits=2) # create K/Y ratio
p$phil <- round(p$labsh*p$rgdpna/(p$labsh*p$rgdpna+.05*p$rnna),digits=2) # create kludge cost share of labor
p <- p %>% group_by(isocode) %>% mutate(lag10.lngdppc = dplyr::lag(lngdppc, n = 10, default = NA)) # 10-year lagged log GDP p.c.
p <- p %>% group_by(isocode) %>% mutate(lag10.lnpop = dplyr::lag(lnpop, n = 10, default = NA)) # 10-year lag log population
p$g10.lngdppc <- (p$lngdppc - p$lag10.lngdppc)/10 # 10-year growth rate of GDP p.c.
p$g10.lnpop <- (p$lnpop - p$lag10.lnpop)/10 # 10-year growth rate of population
p$lagyear <- p$year-10 # initial year for plotting
p$csh_trade <- p$csh_x - p$csh_m # total trade/GDP
p$csh_mabs <- -1*p$csh_m # absolute value of imports/GDP
##################################################################################
# subset PWT into various groups for plotting
##################################################################################
stable <- p[which(p$isocode %in% c("USA", "CAN", "MEX", "GBR", "AUS")),]
catchup <- p[which(p$isocode %in% c("USA", "DEU", "JPN", "KOR", "CHN","NGA")),]
test <- p[which(p$isocode %in% c("ETH", "ZAF","BWA")),]
usa <- p[which(p$isocode %in% c("USA")),]
mix <- p[which(p$isocode %in% c("USA", "MEX", "DEU","JPN","KOR","CHN")),]
##################################################################################
# US-only plots
##################################################################################
fig <- plot_ly(usa, x = ~lagyear, y = ~g10.lnpop, color = ~country, type = 'scatter', mode='lines+markers', colors = "Set1")
fig <- layout(fig, title = list(text = 'Population growth rate', x=0),
xaxis = list(title = 'Year'),
yaxis = list (title = '10-year population growth rate', range=c(0,.02)))
api_create(fig, filename = "pwt-usa-pop-growth")
f <- ggplot(d, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0,0.5)) +
#    geom_smooth(method='lm', se=FALSE, color="black") +
theme_bw()
ggsave("Ch3_xsection_csh_i.eps",path=drafts) # save static version for book
up <- ggplotly(f) # convert to plotly
api_create(up, filename = "Ch3-xsection-csh_i") # upload to plotly
up
f <- ggplot(p, aes(x = gpop, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. growth rate of population, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(-0.01,0,0.01,0.02,0.03,0.04),limits=c(-0.01,0.04)) +
theme_bw()
ggsave("Ch3_xsection_gpop.eps",path=drafts) # save static version for book
up <- ggplotly(f) # convert to plotly
api_create(up, filename = "Ch3-xsection-gpop") # upload to plotly
f <- ggplot(d, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0,0.5)) +
theme_bw()
ggsave("Ch3_xsection_csh_i.eps",path=drafts) # save static version for book
up <- ggplotly(f) # convert to plotly
api_create(up, filename = "Ch3-xsection-cshi") # upload to plotly
f <- ggplot(p, aes(x = gpop, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. growth rate of population, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(-0.01,0,0.01,0.02,0.03,0.04),limits=c(-0.01,0.04)) +
theme_bw()
f
View(p)
data("pwt10.0") # extract PWT data
p <- pwt10.0 # save into dataframe
#p <- p[p$year>1988,] # use only 1989 and forward
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i,na.rm = TRUE)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.5,] # eliminate outliers
p <- p %>% group_by(isocode) %>% # 30-year population growth rate
mutate(gpop = (log(pop) - log(lag(pop, n = 30)))/30)
p <- p[p$gpop<.04,] # eliminate outliers
p <- p[p$rgdpo_pop<100000 & p$rgdpo_pop>500,] # eliminate outliers
p <- p[p$year==2019,] # narrow to only 2019 for graphing and uploading
p <- p %>% drop_na(year)
## Plot GDP per capita against capital formation share
f <- ggplot(d, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0,0.5)) +
theme_bw()
ggsave("Ch3_xsection_csh_i.eps",path=drafts) # save static version for book
up <- ggplotly(f) # convert to plotly
api_create(up, filename = "Ch3-xsection-cshi") # upload to plotly
p <- pwt10.0 # save into dataframe
#p <- p[p$year>1988,] # use only 1989 and forward
# Create variables of interest
p$rgdpo_pop <- p$rgdpo/p$pop # GDP per worker
p <- p %>% group_by(isocode) %>% mutate(mean_csh_i = mean(csh_i,na.rm = TRUE)) # avg cap formation share
p <- p[p$mean_csh_i>0 & p$mean_csh_i<.5,] # eliminate outliers
p <- p %>% group_by(isocode) %>% # 30-year population growth rate
mutate(gpop = (log(pop) - log(lag(pop, n = 30)))/30)
p <- p[p$gpop<.04,] # eliminate outliers
p <- p[p$rgdpo_pop<100000 & p$rgdpo_pop>500,] # eliminate outliers
p <- p[p$year==2019,] # narrow to only 2019 for graphing and uploading
p <- p %>% drop_na(year)
## Plot GDP per capita against capital formation share
f <- ggplot(d, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0,0.5)) +
theme_bw()
View(p)
f <- ggplot(d, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0,0.5)) +
theme_bw()
f
ggsave("Ch3_xsection_csh_i.eps",path=drafts) # save static version for book
up <- ggplotly(f) # convert to plotly
api_create(up, filename = "Ch3-xsection-cshi") # upload to plotly
View(p)
f <- ggplot(p, aes(x = mean_csh_i, y = rgdpo_pop, label = isocode)) +
geom_text(size=3) +
labs(x = "Avg. capital formation share of GDP, 1989-2019", y = "GDP per capita, 2019") +
scale_y_continuous(label=comma,breaks=c(0,1000,2000,4000,8000,16000,32000,64000),trans = scales::log_trans()) +
scale_x_continuous(breaks=c(0,0.05,0.1,0.15,0.2,0.25,0.3,.35,.4,.45,.5),limits=c(0,0.5)) +
theme_bw()
ggsave("Ch3_xsection_csh_i.eps",path=drafts) # save static version for book
up <- ggplotly(f) # convert to plotly
api_create(up, filename = "Ch3-xsection-cshi") # upload to plotly
