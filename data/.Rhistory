install.packages("fredr")
# Rate of cost data
#########################################################################
# Get CSV of return data
p <- read.csv("compustatglobal.csv", header=TRUE)
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_AAA_Setup.r")
# Rate of cost data
#########################################################################
# Get CSV of return data
p <- read.csv("compustatglobal.csv", header=TRUE)
# Rate of cost data
#########################################################################
# Get CSV of return data
g <- read.csv("compustatglobal.csv", header=TRUE)
u <- read.csv("compustatusa.csv", header=TRUE)
g <- rbind(g,u)
# Rate of cost data
#########################################################################
# Get CSV of return data
c <- read.csv("compustat.csv", header=TRUE)
c[, cogs_sale_ratio := cogs/sale]
# Rate of cost data
#########################################################################
# Get CSV of return data
c <- fread("compustat.csv", header=TRUE)
c[, cogs_sale_ratio := cogs/sale]
c[, sga_sale_ratio := sga/sale]
# Rate of cost data
#########################################################################
# Get CSV of return data
c <- fread("compustat.csv", header=TRUE)
c[, cogs_sale_ratio := cogs/sale]
c[, sga_sale_ratio := xsga/sale]
cut <- quantile(c$sga_sale_ratio, probs = c(0.01,0.99))
cut <- quantile(c$sga_sale_ratio, probs = c(0.01,0.99), na.rm=TRUE)
cut
cut[1]
cut(1)
cut[1]
cut[2]
c[sga_sale_ratio > cut[1] & sga_sale_ratio< cut[2]]
# Rate of cost data
#########################################################################
# Get CSV of return data
c <- fread("compustat.csv", header=TRUE)
c[, cogs_sale_ratio := cogs/sale]
c[, sga_sale_ratio := xsga/sale]
cut <- quantile(c$sga_sale_ratio, probs = c(0.01,0.99), na.rm=TRUE)
c[sga_sale_ratio > cut[1] & sga_sale_ratio< cut[2]]
c <- c[sga_sale_ratio > cut[1] & sga_sale_ratio< cut[2]]
b = binsreg(sga_sale_ratio,year,data = c,nbins=40,polyreg=1)
b = binsreg(sga_sale_ratio,year,w = as.factor(nrind2), data = c,nbins=40,polyreg=1)
c[, industry := as.factor(nrind2)]
b = binsreg(sga_sale_ratio,year,w = industry, data = c,nbins=40,polyreg=1)
b = binsreg(cogs_sale_ratio,year,w = industry, data = c,nbins=40,polyreg=1)
# Rate of cost data
#########################################################################
# Get CSV of return data
c <- fread("compustat.csv", header=TRUE)
c[, cogs_sale_ratio := cogs/sale]
c[, sga_sale_ratio := xsga/sale]
cut <- quantile(c$sga_sale_ratio, probs = c(0.01,0.99), na.rm=TRUE)
c <- c[sga_sale_ratio > cut[1] & sga_sale_ratio< cut[2]]
c[, industry := as.factor(nrind2)]
c[, country := as.factor(countrycode)]
b = binsreg(sga_sale_ratio,year,w = c('industry', 'country'), data = c,nbins=40,polyreg=1)
b = binsreg(sga_sale_ratio,year,w = c(industry, country), data = c,nbins=40,polyreg=1)
c[, industry := as.factor(nrind2)]
c[, country := as.factor(countrycode)]
b = binsreg(sga_sale_ratio,year,w = c(industry, country), data = c,nbins=40,polyreg=1)
b = binsreg(sga_sale_ratio,year,w = c('industry'), data = c,nbins=40,polyreg=1)
b = binsreg(sga_sale_ratio ~ year | nrind2 + countrycode, data = c,nbins=40,polyreg=1)
binsreg(sga_sale_ratio ~ year, data = c)
b = binsreg(sga_sale_ratio, year | nrind2 + countrycode, data = c,nbins=40,polyreg=1)
b = binsreg(sga_sale_ratio, year | industry + country, data = c,nbins=40,polyreg=1)
b = binsreg(sga_sale_ratio, year, data = c,nbins=40,polyreg=1)
c[, .(cogs_sale_mean = mean(cogs_sale_ratio)) .(sga_sale_mean = mean(sga_sale_ratio)),
# Rate of cost data
#########################################################################
# Get CSV of return data
c <- fread("compustat.csv", header=TRUE)
c[, cogs_sale_ratio := cogs/sale]
c[, sga_sale_ratio := xsga/sale]
cut <- quantile(c$sga_sale_ratio, probs = c(0.01,0.99), na.rm=TRUE)
c <- c[sga_sale_ratio > cut[1] & sga_sale_ratio< cut[2]]
c[, industry := as.factor(nrind2)]
c[, country := as.factor(countrycode)]
c[, lapply(.SD, mean), .SDcols=c('cogs_sale_ratio','sga_sale_ratio'), by=.(nrind2, countrycode)]
# Rate of cost data
#########################################################################
# Get CSV of return data
c <- fread("compustat.csv", header=TRUE)
c[, cogs_sale_ratio := cogs/sale]
c[, sga_sale_ratio := xsga/sale]
cut <- quantile(c$sga_sale_ratio, probs = c(0.01,0.99), na.rm=TRUE)
c <- c[sga_sale_ratio > cut[1] & sga_sale_ratio< cut[2]]
c <- c[, lapply(.SD, mean), .SDcols=c('cogs_sale_ratio','sga_sale_ratio'), by=.(nrind2, countrycode)]
# Rate of cost data
#########################################################################
# Get CSV of return data
c <- fread("compustat.csv", header=TRUE)
c[, cogs_sale_ratio := cogs/sale]
c[, sga_sale_ratio := xsga/sale]
cut <- quantile(c$sga_sale_ratio, probs = c(0.01,0.99), na.rm=TRUE)
c <- c[sga_sale_ratio > cut[1] & sga_sale_ratio< cut[2]]
c <- c[, lapply(.SD, mean), .SDcols=c('cogs_sale_ratio','sga_sale_ratio'), by=.(nrind2, countrycode, year)]
b = binsreg(sga_sale_ratio, year, data = c,nbins=40,polyreg=1)
b = binsreg(cogs_sale_ratio,year,data = c,nbins=40,polyreg=1)
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
fig
fig <- plot_ly(sgadot, x = ~x, y = ~fit, type = 'scatter',name = 'SGA')
fig <- fig %>% add_trace(x = ~x, y = ~fit, data = cogdot, name = 'COGS', type = 'scatter')
#saveWidget(partial_bundle(fig), "../plotly/jst-stable-return.html",selfcontained = F, libdir = "lib")
fig
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
fig
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
fig
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
fig
fig
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
fig
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
fig
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
fig
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
fig
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
fig
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_Compustat_Facts.r")
source("~/Library/CloudStorage/Dropbox/Project/StudyGuide/code/Guide_OECD_Structural.r")
fwrite(f, "~/Dropbox/project/studyguide/data/usa_consumption_data.csv")
